<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Register | UMS</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="public/css/style.css">
</head>
<body>
  <div class="container-card">
    <h2>Create Account ✨</h2>
    <form id="registerForm">
      <div class="mb-3">
        <input type="text" id="name" class="form-control" placeholder="Full Name" required>
      </div>
      <div class="mb-3">
        <input type="email" id="email" class="form-control" placeholder="Email" required>
      </div>
      <div class="mb-3">
        <input type="password" id="password" class="form-control" placeholder="Password" required minlength="6">
      </div>
      <button class="btn btn-primary w-100" type="submit">Register</button>
      <p class="text-center mt-3">Already have an account? <a href="login.html">Login</a></p>
      <div id="msg" class="mt-2 text-center text-danger"></div>
    </form>
  </div>
  <script>
  const api = 'https://ums-backend-1.onrender.com';

  document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    // ✅ Always reference inputs via getElementById
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const msg = document.getElementById('msg');

    const body = {
      name: nameInput.value.trim(),
      email: emailInput.value.trim(),
      password: passwordInput.value.trim()
    };

    // Simple validation before sending
    if (!body.name || !body.email || !body.password) {
      msg.textContent = "Please fill all fields.";
      msg.classList.add('text-red-600');
      return;
    }

    try {
      const res = await fetch(api + '/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
      });

      const data = await res.json();

      if (data.msg === 'User created') {
        msg.textContent = '✅ Registration successful! Redirecting...';
        msg.classList.remove('text-red-600');
        msg.classList.add('text-green-600');
        setTimeout(() => location.href = 'login.html', 1000);
      } else {
        msg.textContent = data.msg || data.error || 'Error during registration.';
        msg.classList.add('text-red-600');
      }

    } catch (err) {
      msg.textContent = 'Server error. Please try again later.';
      console.error(err);
    }
  });
</script>

</body>
</html>
